"use strict";angular.module("webClient",["ui.router"]).config(["$stateProvider","$urlRouterProvider",function(e,o){o.otherwise("/entrance"),e.state("entrance",{url:"/entrance",templateUrl:"/pages/entrance/entrance.html",controller:"EntranceController"}).state("chatRoom",{url:"/chat-room/user/{user}/room/{room}",templateUrl:"/pages/chat-room/chat-room.html",controller:"ChatRoomController"})}]),angular.module("webClient").factory("wsCommunicator",function(){function e(e,o,n){r=new WebSocket("ws://"+e+"/api/ws"),r.onmessage=function(e){var o=JSON.parse(e.data);"BROADCAST_TEXT_MESSAGE"==o.msgType&&"function"==typeof a.receiveMessage&&a.receiveMessage(JSON.parse(o.data))},setTimeout(function(){r.send(JSON.stringify({msgType:"HANDSHAKE",data:JSON.stringify({room:o,user:n})}))},300)}function o(e){a.receiveMessage=e}function n(e){a.close=e,r&&(r.onclose=e)}function t(){r.close()}function s(e){r.send(JSON.stringify({msgType:"SEND_TEXT_MESSAGE",data:JSON.stringify(e)}))}var r,a={};return{connect:e,disconnect:t,sendMessage:s,setReceiveMessageCallback:o,setCloseConnectionCallback:n}}),angular.module("webClient").controller("ChatRoomController",["$scope","$state","$stateParams","wsCommunicator",function(e,o,n,t){e.room=n.room,e.user=n.user,e.message={message:""},e.roomMessages=[],t.setReceiveMessageCallback(function(o){e.roomMessages.push({color:o.author===e.user?"blue":"black",text:"["+o.author+"]: "+o.message}),e.$apply()}),t.setCloseConnectionCallback(function(){console.log("connection closed")}),t.connect(window.location.host,e.room,e.user),e.sendMessage=function(){t.sendMessage(e.message),e.message=""}}]),angular.module("webClient").controller("EntranceController",["$scope","$state","wsCommunicator",function(e,o,n){e.checkEnterPossible=function(){return e.user&&e.room},e.enterRoom=function(){e.user&&e.room&&o.go("chatRoom",{user:e.user,room:e.room})}}]);
//# sourceMappingURL=js-maps/app.js.map
